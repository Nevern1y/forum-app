# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞–∫—Ä—É—Ç–∫–∏ –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤ –ø–æ—Å—Ç–æ–≤

## –ü—Ä–æ–±–ª–µ–º–∞
–ö–∞–∂–¥—ã–π —Ä–∞–∑ –∫–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞—Ö–æ–¥–∏—Ç –Ω–∞ –ø–æ—Å—Ç, —Å—á–µ—Ç—á–∏–∫ –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–¥–Ω–æ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –Ω–∞–∫—Ä—É—á–∏–≤–∞—Ç—å –ø—Ä–æ—Å–º–æ—Ç—Ä—ã.

## –†–µ—à–µ–Ω–∏–µ
–°–æ–∑–¥–∞–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤:
- ‚úÖ –û–¥–∏–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å = –æ–¥–∏–Ω –ø—Ä–æ—Å–º–æ—Ç—Ä –Ω–∞ –ø–æ—Å—Ç (–Ω–∞–≤—Å–µ–≥–¥–∞)
- ‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç –Ω–∞–∫—Ä—É—Ç–∫–∏
- ‚úÖ –°—á–µ—Ç—á–∏–∫ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ä–µ–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∑—Ä–∏—Ç–µ–ª–µ–π

## –ö–∞–∫ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ß–µ—Ä–µ–∑ Supabase Dashboard (–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

1. **–û—Ç–∫—Ä–æ–π—Ç–µ Supabase Dashboard**
   - –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ https://supabase.com
   - –í–æ–π–¥–∏—Ç–µ –≤ —Å–≤–æ–π –ø—Ä–æ–µ–∫—Ç

2. **–û—Ç–∫—Ä–æ–π—Ç–µ SQL Editor**
   - –í –ª–µ–≤–æ–º –º–µ–Ω—é –≤—ã–±–µ—Ä–∏—Ç–µ "SQL Editor"
   - –ù–∞–∂–º–∏—Ç–µ "New Query"

3. **–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏—é**
   ```sql
   -- –í—Å—Ç–∞–≤—å—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞:
   supabase/migrations/010_fix_post_views_tracking.sql
   ```

4. **–ù–∞–∂–º–∏—Ç–µ "Run"**

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ß–µ—Ä–µ–∑ –ø–æ–ª–Ω—É—é –º–∏–≥—Ä–∞—Ü–∏—é

–ï—Å–ª–∏ –≤—ã –∑–∞–ø—É—Å–∫–∞–µ—Ç–µ –ø—Ä–æ–µ–∫—Ç —Å –Ω—É–ª—è, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ:
```sql
-- –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –≤–µ—Å—å —Ñ–∞–π–ª:
supabase/migrations/run_all_migrations.sql
```

## –ß—Ç–æ –∏–∑–º–µ–Ω–∏—Ç—Å—è?

### –î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞—Ö–æ–¥–∏—Ç –Ω–∞ –ø–æ—Å—Ç ‚Üí +1 –ø—Ä–æ—Å–º–æ—Ç—Ä
–¢–æ—Ç –∂–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞—Ö–æ–¥–∏—Ç —Å–Ω–æ–≤–∞ ‚Üí +1 –ø—Ä–æ—Å–º–æ—Ç—Ä
–†–µ–∑—É–ª—å—Ç–∞—Ç: –ù–∞–∫—Ä—É—Ç–∫–∞! üò¢
```

### –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞—Ö–æ–¥–∏—Ç –Ω–∞ –ø–æ—Å—Ç ‚Üí +1 –ø—Ä–æ—Å–º–æ—Ç—Ä
–¢–æ—Ç –∂–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞—Ö–æ–¥–∏—Ç —Å–Ω–æ–≤–∞ ‚Üí 0 (—É–∂–µ —É—á—Ç–µ–Ω–æ)
–†–µ–∑—É–ª—å—Ç–∞—Ç: –ß–µ—Å—Ç–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞! ‚úÖ
```

## –í–∞–∂–Ω–æ!

‚ö†Ô∏è **–°—á–µ—Ç—á–∏–∫–∏ –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤ –±—É–¥—É—Ç —Å–±—Ä–æ—à–µ–Ω—ã –¥–æ 0**

–≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ, —Ç–∞–∫ –∫–∞–∫ —Å—Ç–∞—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ –±—ã–ª–∏ –Ω–µ—Ç–æ—á–Ω—ã–º–∏ (—Å –Ω–∞–∫—Ä—É—Ç–∫–æ–π). –ü–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏–∏ —Å—á–µ—Ç—á–∏–∫–∏ –±—É–¥—É—Ç –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å —á–µ—Å—Ç–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∑—Ä–∏—Ç–µ–ª–µ–π.

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

### –°–æ–∑–¥–∞–Ω–æ:
1. **–¢–∞–±–ª–∏—Ü–∞ `post_views`** - —Ö—Ä–∞–Ω–∏—Ç –∫—Ç–æ –∏ –∫–æ–≥–¥–∞ —Å–º–æ—Ç—Ä–µ–ª –∫–∞–∂–¥—ã–π –ø–æ—Å—Ç
   - `post_id` - ID –ø–æ—Å—Ç–∞
   - `user_id` - ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
   - `viewed_at` - –∫–æ–≥–¥–∞ –ø–æ—Å–º–æ—Ç—Ä–µ–ª
   - –£–Ω–∏–∫–∞–ª—å–Ω–æ–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ: `(post_id, user_id)` - –æ–¥–∏–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å = –æ–¥–∏–Ω –ø—Ä–æ—Å–º–æ—Ç—Ä

2. **–§—É–Ω–∫—Ü–∏—è `increment_post_views(post_id)`** - —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —Å—á–µ—Ç—á–∏–∫ —Ç–æ–ª—å–∫–æ —Ä–∞–∑ –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `ON CONFLICT DO NOTHING` –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –¥—É–±–ª–∏–∫–∞—Ç–æ–≤
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç —Å—á–µ—Ç—á–∏–∫ –∏–∑ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π

3. **RLS –ø–æ–ª–∏—Ç–∏–∫–∏** - –∑–∞—â–∏—Ç–∞ –¥–∞–Ω–Ω—ã—Ö
   - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤–∏–¥—è—Ç —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –ø—Ä–æ—Å–º–æ—Ç—Ä—ã
   - –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–ª—è—Ç—å —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –ø—Ä–æ—Å–º–æ—Ç—Ä—ã

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:
- ‚úÖ –ò–Ω–¥–µ–∫—Å—ã –Ω–∞ `post_id` –∏ `user_id`
- ‚úÖ –ë—ã—Å—Ç—Ä—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏
- ‚úÖ –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

–ü–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏–∏:

1. **–ó–∞–π–¥–∏—Ç–µ –Ω–∞ –ª—é–±–æ–π –ø–æ—Å—Ç** ‚Üí —Å—á–µ—Ç—á–∏–∫ +1
2. **–û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É** ‚Üí —Å—á–µ—Ç—á–∏–∫ –Ω–µ –∏–∑–º–µ–Ω–∏–ª—Å—è ‚úÖ
3. **–ó–∞–π–¥–∏—Ç–µ –¥—Ä—É–≥–∏–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º** ‚Üí —Å—á–µ—Ç—á–∏–∫ +1 ‚úÖ

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ —Å–±—Ä–æ—Å–∏—Ç—å –ø—Ä–æ—Å–º–æ—Ç—Ä—ã –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–æ—Å—Ç–∞:
```sql
DELETE FROM post_views WHERE post_id = 'your-post-id';
UPDATE posts SET views = 0 WHERE id = 'your-post-id';
```

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∫—Ç–æ —Å–º–æ—Ç—Ä–µ–ª –ø–æ—Å—Ç:
```sql
SELECT p.username, pv.viewed_at 
FROM post_views pv
JOIN profiles p ON p.id = pv.user_id
WHERE pv.post_id = 'your-post-id'
ORDER BY pv.viewed_at DESC;
```
